---
title: Modify Markdown files
type: note
tags: 
    - colophon
---

See also: [[convert-wordpress-into-memex]], [[colophon]]

The second last step of the process to [[convert-wordpress-into-memex|convert my Wordpress blog]] into `mkdocs` generated site. This step modifies the markdown files produced in the  [[export-wordpress-to-markdown]] process and generates new content for the purposes of:

- Modify markdown sourced from Wordpress to tidy up any outdated content/links to make it fit within `mkdocs` requirements.
- Modify the structure of the exported data to re-create the blog structure.
- Generate new content to re-create additional blog content (e.g. category pages, tag pages, archives, RSS feeds, adding comments/pingbacks)

Done in two main Python scripts

1. `blogTidyUp.py` - Run from the [Memex repo](https://djon.es/memex) to modify the markdown files from the previous step and relocate them into the blog repo. Run once to generate/rewrite the blog structure.
2. Use [[computational-components]] (e.g. `blog.py`) running from within `mkdocs` to generation additional markdown files during the site build process.

## To do

- Create categories and archives pages

    - linked from the top nav
        - ~/archives/
        - ~/category/
    - go to a page that shows a list of all archives/categories
    - perhaps with nice interface (eventually)
    - perhaps with some sort of introduction
- Add list of categories in the right hand menu on category pages
- Add list of archives in the right hand menu on archive pags

    - add "categories" list to the YAML frontmatter of each category page
    - add "archives" list to the YAML frontmatter of each archive page
    - both use the blog-cagtegory.html template
    - Use a conditional in the template to modify the right/left menu contents  

- Create "home pages" for categories and archives - e.g. https://blog.jim-nielsen.com/archive/)

- Increase font size to 1rem

RSS
- Explore if possible to set the feed URL to same as Wordpress - djon.es/blog/feed/
    - There is a redirect mod for mkdocs, but doesn't like to work with genfiles, use apache config instead?
- Improve the <link> header embeds in template to match Wordpress
- Add RSS button to header/navigation

## `blogTidyUp.py`

Three main steps

1. Parse the Wordpress XML file to extract additional data used in the following steps.
2. Read, modify, and move the markdown files for blog pages.
3. Read, modify, and move the markdown files for blog posts.

The distinction between pages and posts is made because:

- `wpparse` places pages and posts into separate folders; and,
- the `mkdoc` blog's intended folder structure for pages and posts differs.

However, the the same process is performed for both pages and posts:

1. Read the content of the markdown file produced by `wpparse`
2. Modify the content by

    - converting the publish date to a string
    - clean up the content of the file using data from the XML file

        Changes made includes:

        - replace davidtjones.wordpress.com links with djon.es links
        - convert djon.es full links to absolute links within mkdocs
        - remove any links internal to the blog post/page
        - change Comments author "admin" to "David Jones"
    - clean up the YAML front matter for the post/page
3. Move the file to the correct location by

    - creating and copying any images and other resource files to the correct location
    - writing an updated index file with the post/page content

## Computational components

[`mkdocs-gen-file`](https://oprypin.github.io/mkdocs-gen-files/index.html) is a plugin for the `mkdocs` static site generator used to publish the new blog. `mkdocs-gen-file` enables the integration of local Pythons scripts into the `mkdocs` build process. A primary enabler of the [[computational-components]] approach used in this site.

For the blog, the primary computational components is `blog.py`, which performs the following tasks:

- Generate category pages.

    At the time of this work blog posts were allocated into 152 different categories. A category page lists an excerpt of all the posts belonging to the category.
- Generate an RSS feed - using [python-feedgen](https://feedgen.kiesow.be) of the 20 most recent posts.
- Generate the home page, which

    - adds excerpts of the 20 most recent posts to the home page
    - generate archive pages for all posts

        An archive page is a list of all posts for a month and year.
    - adds to the left-column of the home page a navigable list of archive pages.


[//begin]: # "Autogenerated link references for markdown compatibility"
[convert-wordpress-into-memex]: convert-wordpress-into-memex "Convert Wordpress into Memex"
[colophon]: colophon "About (Colophon)"
[convert-wordpress-into-memex|convert my Wordpress blog]: convert-wordpress-into-memex "Convert Wordpress into Memex"
[export-wordpress-to-markdown]: export-wordpress-to-markdown "Export Wordpress to Markdown"
[computational-components]: computational-components "Computational components"
[//end]: # "Autogenerated link references"